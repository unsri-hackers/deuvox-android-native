def baseEnvPropertiesFile = rootProject.file("base-env.properties")
def baseEnvProperties = new Properties()
baseEnvProperties.load(new FileInputStream(baseEnvPropertiesFile))

ext.flavors = {

    flavorDimensions FLAVORS_DIMENSION

    productFlavors {
        development {
            dimension FLAVORS_DIMENSION
            ext.appSuffix = ".dev"
            resValue "string", "app_name", APP_NAME_DEV

            buildConfigField 'String', 'BASE_URL', "\"${baseEnvProperties['devApiUrl']}\""
        }

        preproduction {
            dimension FLAVORS_DIMENSION
            ext.appSuffix = ".preprod"
            resValue "string", "app_name", APP_NAME_PREPROD
            buildConfigField 'String', 'BASE_URL', "\"${baseEnvProperties['preProdApiUrl']}\""
        }

        production {
            dimension FLAVORS_DIMENSION
            ext.appSuffix = ".prod"
            resValue "string", "app_name", APP_NAME

            buildConfigField 'String', 'BASE_URL', "\"${baseEnvProperties['productionApiUrl']}\""
        }
    }

    productFlavors.all { flavor ->
        if (flavor.hasProperty('appSuffix') && isApplicationProject()) {
            flavor.applicationIdSuffix = flavor.appSuffix
        }
    }

}

def isApplicationProject() {
    return project.name == "app"
}
